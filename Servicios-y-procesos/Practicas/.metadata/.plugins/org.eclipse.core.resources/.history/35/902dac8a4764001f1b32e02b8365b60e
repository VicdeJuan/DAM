package ejercicio1;

import java.util.Scanner;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;


public class MainDescifradorPool {
	

	public static void main(String[] args) {
		
		String contraseña;
		String descifrada = "";
		int numHilos = 26;
		Scanner scanner = new Scanner(System.in);
        
        
        System.out.print("Por favor, escribe la contraseña a descifrar: ");
         contraseña = scanner.nextLine();
	
		
	
        long startTime = System.currentTimeMillis();
        byte[] encodedhash = Encoder.getHash(contraseña);
        
        
        ExecutorService pool = Executors.newFixedThreadPool(4);
        
        char c1;
        
        // Enviar 10 tareas al pool
        if (encodedhash != null) {
		
	        for (c1 = 'a'; c1 <= 'z'; c1++) {
	            pool.submit(() -> {
	            	new DescifradorParalelo(encodedhash,contraseña.length()-1,""+c1);
	            });
	        }

	        // Cerrar el pool
	        pool.shutdown();
	        
	
	        descifrada = DescifradorParalelo.getContraseñaEncontrada();
		}
   
        long endTime = System.currentTimeMillis();

        long tiempoTranscurrido = endTime - startTime;
        System.out.println("Tiempo de ejecución: " + tiempoTranscurrido + " ms");
		System.out.println("Contraseña descifrada: " + descifrada);
		
		scanner.close();
		
	}
}
